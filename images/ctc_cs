if(typeof(_cami_system)=="undefined"){var _cami_system=[];_cami_system.mobile_device=false;_cami_system.user_browser=new Object;_cami_system.user_browser.check_version;_cami_system.user_browser.ie=false;_cami_system.user_browser.ie6=false;_cami_system.user_browser.ie7=false;_cami_system.user_browser.ie8=false;_cami_system.user_browser.ie9=false;_cami_system.user_agent=navigator.userAgent.toLowerCase();if(_cami_system.user_agent.indexOf("msie")!=-1){_cami_system.user_browser.ie=true;_cami_system.user_browser.check_version=_cami_system.user_agent.match(/msie ([\d.]+)/)[1].substr(0,1);if(_cami_system.user_browser.check_version==6)_cami_system.user_browser.ie6=true;if(_cami_system.user_browser.check_version==7)_cami_system.user_browser.ie7=true;if(_cami_system.user_browser.check_version==8)_cami_system.user_browser.ie8=true;if(_cami_system.user_browser.check_version==9)_cami_system.user_browser.ie9=true}_cami_system.version_format=function(version){var version_split=version.split(".");var version_format="";for(var i in version_split){version_format=""+version_format+""+pad_left(0,3,version_split[i])+""}version_format=parseInt(version_format);return version_format;function pad_left(prefix,length,str){for(var i=str.length;i<length;i++){str=""+prefix+""+str+""}return str}};_cami_system.jQuery_include=(typeof(jQuery)!="undefined")?true:false;_cami_system.jQuery_include_version=(_cami_system.jQuery_include)?_cami_system.version_format(jQuery.fn.jquery):null;_cami_system.jQuery_valid;_cami_system.in_use_jQuery_version=null;_cami_system.load_js_src=[];_cami_system.js_load_state="";_cami_system.$;_cami_system.check_onload=0;_cami_system.cookie_status=false;_cami_system.show_list_x;_cami_system.show_list_y;_cami_system.hide_show_list_timeout;_cami_system.only_one_unit=true;_cami_system.ol_check=0;_cami_system.online_status_update_ajax;_cami_system.refresh_ajax;_cami_system.online_status_update_status=false;_cami_system.refresh_status=false;_cami_system.online_status_last_time=0;_cami_system.refresh_last_time=0;_cami_system.online_status_timeout;_cami_system.refresh_timeout;_cami_system.request_check_timeout;_cami_system.hs="";_cami_system.cid="EYS9GETR923FXW0DPBN0SX02HK4OXA02ZI15NLNMDHS03J3JLGA341VBBQQYRGQGPIC2TPEWWXNQ6GZHN0BIRXKSE0HV7Y1M63EQ";_cami_system.gid="";_cami_system.gid_exists=0;_cami_system.bid="3232b07f-1f8b-6059-947d-e6a8a3705fca";_cami_system.include="elasticity_v2";_cami_system.service_alert_1=0;_cami_system.service_alert_2=0;_cami_system.action_number=0;_cami_system.extension={};_cami_system.bridge_setup=false;_cami_system.bridge={};_cami_system.bridge_temp={};_cami_system.bridge_querystring="";_cami_system.mode="department";_cami_system.display="simple";_cami_system.duty_hash={"8604f22e":"143"};_cami_system.mx="";_cami_system.my="";_cami_system.lmx="";_cami_system.lmy="";_cami_system.mnv=0;_cami_system.pics={"online":"//service.capcom.com.tw/static/service/icon1.jpg","busy":"//service.capcom.com.tw/static/service/icon2.jpg","offline":"//service.capcom.com.tw/static/service/icon3.jpg"};_cami_system.charset="utf-8";_cami_system.keywords="";_cami_system.elasticity_type="";_cami_system.elasticity_id="";if(_cami_system.jQuery_include==true&&_cami_system.jQuery_include_version>=1007002&&_cami_system.jQuery_include_version<3000000){_cami_system.jQuery_valid=true}else{_cami_system.jQuery_valid=false;_cami_system.load_js_src.push("http://p37.cami.yesing.com/application/js/jquery-1.12.4_sp.min.js?NTU0NWJhZGM")}_cami_system.get_flash_version=function(){var version="";var user_agent=navigator.userAgent.toLowerCase();if((user_agent.indexOf("msie")!=-1)){for(var i=10;i>=2;i--){try{var object=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i+"");if(object){version=i;break}}catch(e){}}}else{if(navigator.plugins&&navigator.plugins.length>0){var swf=navigator.plugins["Shockwave Flash"];if(swf){var checks=swf.description.split(" ");for(var i=0;i<checks.length;++i){if(isNaN(parseInt(checks[i]))){continue}version=checks[i]}}}}return parseFloat(version)};_cami_system.get_now_time=function(){return Math.round(new Date().getTime()/1000)};_cami_system.get_metas=function(){var metas=document.getElementsByTagName('meta');var charset,get_charset,meta_content,keywords;for(var i=0;i<metas.length;i++){get_charset=metas[i].getAttribute('charset');if(get_charset){charset=get_charset;break}else if(metas[i].content){meta_content=metas[i].content.toLowerCase();if(meta_content.match(/charset/)){charset=meta_content.split('=')[1];break}}}for(var i=0;i<metas.length;i++){if(metas[i].name&&metas[i].name=='keywords'&&metas[i].content){keywords=metas[i].content;break}}if(charset){_cami_system.charset=charset}if(keywords){_cami_system.keywords=keywords}};_cami_system.create_cookie=function(name,value,vaild_time){if(vaild_time){var date=new Date();date.setTime(date.getTime()+vaild_time*1000);var expires="; expires="+date.toGMTString()+""}else{var expires=""}document.cookie=name+"="+value+expires+"; path=/"};_cami_system.read_cookie=function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length)}}return null};_cami_system.erase_cookie=function(name){create_cookie(name,"",-1)};_cami_system.check_cookie=function(){_cami_system.create_cookie("_cami_check_cookie","valid");var check=_cami_system.read_cookie("_cami_check_cookie");if(check&&check=="valid"){_cami_system.cookie_status=true;return true}else{return false}};_cami_system.set_gid=function(gid){if(_cami_system.cookie_status==true){_cami_system.create_cookie("_cami_gid",gid,315532800);_cami_system.gid=gid}};_cami_system.get_gid=function(){_cami_system.gid=_cami_system.read_cookie("_cami_gid");if(_cami_system.gid!=null){_cami_system.gid_exists=1}else{_cami_system.gid=""}};_cami_system.urlencode=function(s){return encodeURIComponent(s).replace(/\%20/g,'+').replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/\~/g,'%7E')};_cami_system.utf8_encode=function(s){if(s===null||typeof s==='undefined'){return''}var string=(s+'');var utftext='',start,end,stringl=0;start=end=0;stringl=string.length;for(var n=0;n<stringl;n++){var c1=string.charCodeAt(n);var enc=null;if(c1<128){end++}else if(c1>127&&c1<2048){enc=String.fromCharCode((c1>>6)|192)+String.fromCharCode((c1&63)|128)}else{enc=String.fromCharCode((c1>>12)|224)+String.fromCharCode(((c1>>6)&63)|128)+String.fromCharCode((c1&63)|128)}if(enc!==null){if(end>start){utftext+=string.slice(start,end)}utftext+=enc;start=end=n+1}}if(end>start){utftext+=string.slice(start,stringl)}return utftext};_cami_system.base64_encode=function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!data){return data}data=this.utf8_encode(data+'');do{o1=data.charCodeAt(i++);o2=data.charCodeAt(i++);o3=data.charCodeAt(i++);bits=o1<<16|o2<<8|o3;h1=bits>>18&0x3f;h2=bits>>12&0x3f;h3=bits>>6&0x3f;h4=bits&0x3f;tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}while(i<data.length);enc=tmp_arr.join('');switch(data.length%3){case 1:enc=enc.slice(0,-2)+'==';break;case 2:enc=enc.slice(0,-1)+'=';break}return enc};_cami_system.get_var=function(){_cami_system.active_talk_width=_cami_system.$("#cami_active_talk").outerWidth();_cami_system.active_talk_height=_cami_system.$("#cami_active_talk").outerHeight();_cami_system.service_alert_width=_cami_system.$("#cami_service_alert").outerWidth();_cami_system.service_alert_height=_cami_system.$("#cami_service_alert").outerHeight();_cami_system.show_list_width=_cami_system.$("#cami_show_list").outerWidth();_cami_system.show_list_height=_cami_system.$("#cami_show_list").outerHeight();_cami_system.client_width=_cami_system.$(window).width();_cami_system.client_height=(typeof(window.innerWidth)=="number")?window.innerHeight:document.documentElement.clientHeight;_cami_system.client_scroll_top=_cami_system.$(document).scrollTop();_cami_system.client_scroll_left=_cami_system.$(document).scrollLeft()};_cami_system.load_css=function(){var h=document.getElementsByTagName("head")[0];var c=document.createElement("link");c.type="text/css";c.rel="stylesheet";c.href="http://p37.cami.yesing.com/application/css/patrol/default.css?NTU0NWJhZGM";h.appendChild(c)};_cami_system.load_js=function(src){src=src||"";if(_cami_system.js_load_state==""){if(src||_cami_system.load_js_src.length>0){_cami_system.js_load_state="loading";if(!src){src=_cami_system.load_js_src.shift()}var get_elem=document.getElementsByTagName("script");for(var i=0;i<get_elem.length;i++){if(get_elem[i].src==src){_cami_system.js_load_state="";return _cami_system.load_js()}}var s=document.createElement("script");s.setAttribute("type","text/javascript");s.setAttribute("src",src);var h=document.getElementsByTagName("head")[0];if(h){h.appendChild(s)}else{document.body.appendChild(s)}s.onload=s.onreadystatechange=function(){if(s.readyState&&s.readyState=="loading")return;_cami_system.js_load_state=""};s.onerror=function(){h.removeChild(s)};_cami_system.load_js()}else{_cami_system.load_complete(1)}}else{setTimeout(function(){_cami_system.load_js(src)},10)}};_cami_system.load_complete=function(first_run){first_run=first_run||0;if(first_run==1){if(_cami_system.jQuery_valid==true){_cami_system.$=jQuery}else{_cami_system.$=_YesingjQuerySp}_cami_system.in_use_jQuery_version=parseInt(_cami_system.$.fn.jquery.split('.').join(''));_cami_system.$.extend(_cami_system.$.easing,{def:'easeOutExpo',easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b}});_cami_system.bridge_handle();_cami_system.check_cookie();_cami_system.get_gid();_cami_system.get_metas();_cami_system.request_check(true);_cami_system.$(window).on("focus online",function(){_cami_system.request_check()});_cami_system.pic_preload=new Object;_cami_system.pic_preload.online=new Image;_cami_system.pic_preload.busy=new Image;_cami_system.pic_preload.offline=new Image;_cami_system.pic_preload.online.onload=function(){};_cami_system.pic_preload.busy.onload=function(){};_cami_system.pic_preload.offline.onload=function(){};_cami_system.pic_preload.online.src=_cami_system.pics.online;_cami_system.pic_preload.busy.src=_cami_system.pics.busy;_cami_system.pic_preload.offline.src=_cami_system.pics.offline;_cami_system.$(function(){_cami_system.check_onload=1});_cami_system.$(window).load(function(){_cami_system.check_onload=1});_cami_system.$(document).on("mousemove",function(event){_cami_system.mx=event.pageX;_cami_system.my=event.pageY});_cami_system.refresh(first_run)}if(_cami_system.check_onload!==1){setTimeout(function(){_cami_system.load_complete()},10);return false}else if(_cami_system.ol_check==0){_cami_system.ol_check=1;var html=''+'<div id="cami_system_container" class="cami_system_elem" style="position:relative; display:none;">'+'<div id="cami_patrol_tool"></div>'+'<div id="cami_show_list" style="position:absolute; top:-10000px; left:-10000px;"></div>'+'</div>'+'<div id="cami_active_talk" class="cami_system_elem"></div>'+'<div id="cami_service_alert" class="cami_system_elem"></div>'+'<div id="cami_robot_active" class="cami_system_elem">'+'<div class="cami_alpha_bg"></div>'+'<div class="cami_content_container">'+'<div class="cami_content_wrap">'+'<div class="cami_content"></div>'+'</div>'+'</div>'+'<div class="cami_close" onclick="_cami_system.robotActiveHide(); return false;">&#215</div>'+'</div>';_cami_system.$("body").append(html);_cami_system.$(".cami_system_elasticity").each(function(){var id=_cami_system.$(this).attr("id");if(id&&(id.indexOf("cami_system_dp_")!=-1||id.indexOf("cami_system_op_")!=-1)){_cami_system.elasticity_type="id";_cami_system.elasticity_id+=","+id.split("_")[3]+""}else{_cami_system.elasticity_type="class";var classes=_cami_system.$(this).attr("class").split(/\s+/);for(var i in classes){if(classes[i].indexOf("cami_system_dp_")!=-1||classes[i].indexOf("cami_system_op_")!=-1){_cami_system.elasticity_id+=","+classes[i].split("_")[3]+"";break}}}});_cami_system.elasticity_id=_cami_system.elasticity_id.substr(1);_cami_system.panel_placement(true,'[{"id":"143","name":"&#23458&#26381&#37096","state":0,"elasticity_id":"74c24a20"}]');if(first_run!=1){_cami_system.refresh(0,1)}else{_cami_system.refresh_timeout=setTimeout(function(){_cami_system.refresh(0,1)},180000)}_cami_system.$(window).resize(function(){_cami_system.init_elem();_cami_system.robotActiveResize()});_cami_system.$(window).scroll(function(){_cami_system.init_elem()})}};_cami_system.init_elem=function(init_active_talk,init_service_alert_1,init_service_alert_2,init_show_list){init_active_talk=init_active_talk||null;init_service_alert_1=init_service_alert_1||null;init_service_alert_2=init_service_alert_2||null;init_show_list=init_show_list||null;var check_active_talk_display=_cami_system.$("#cami_active_talk").css("display");var check_service_alert_display=_cami_system.$("#cami_service_alert").css("display");var check_show_list_display=_cami_system.$("#cami_show_list").css("display");if(init_active_talk||init_service_alert_1||init_service_alert_2||check_show_list_display||check_active_talk_display=="block"||check_service_alert_display=="block"||check_show_list_display=="block"){_cami_system.get_var()}if(init_active_talk){_cami_system.$("#cami_active_talk").css({'top':(Math.round((_cami_system.client_height-_cami_system.active_talk_height)/3)+_cami_system.client_scroll_top),'left':(Math.round((_cami_system.client_width-_cami_system.active_talk_width)/2)+_cami_system.client_scroll_left)}).show()}else if(check_active_talk_display=="block"){_cami_system.$("#cami_active_talk").stop().animate({'top':(Math.round((_cami_system.client_height-_cami_system.active_talk_height)/3)+_cami_system.client_scroll_top),'left':(Math.round((_cami_system.client_width-_cami_system.active_talk_width)/2)+_cami_system.client_scroll_left)},1500,"easeOutExpo")}if(init_service_alert_1||init_service_alert_2){_cami_system.$("#cami_service_alert").css({'top':(Math.round((_cami_system.client_height-_cami_system.service_alert_height)/3)+_cami_system.client_scroll_top),'left':(Math.round((_cami_system.client_width-_cami_system.service_alert_width)/2)+_cami_system.client_scroll_left)}).show();if(init_service_alert_1){_cami_system.create_cookie("cami_sa_ignore_1",1);this.eventsOn('service_alert_1')}if(init_service_alert_2){_cami_system.create_cookie("cami_sa_ignore_1",1);_cami_system.create_cookie("cami_sa_ignore_2",1);this.eventsOn('service_alert_2')}}else if(check_service_alert_display=="block"){_cami_system.$("#cami_service_alert").stop().animate({'top':(Math.round((_cami_system.client_height-_cami_system.service_alert_height)/3)+_cami_system.client_scroll_top),'left':(Math.round((_cami_system.client_width-_cami_system.service_alert_width)/2)+_cami_system.client_scroll_left)},1500,"easeOutExpo")}if(init_show_list){if((_cami_system.show_list_click_page_x+_cami_system.show_list_width+5)<=(_cami_system.client_width+_cami_system.client_scroll_left)){_cami_system.show_list_x=_cami_system.show_list_click_layer_x+5}else{_cami_system.show_list_x=_cami_system.show_list_click_layer_x-_cami_system.show_list_width-5}if((_cami_system.show_list_click_page_y+_cami_system.show_list_height+5)<=(_cami_system.client_height+_cami_system.client_scroll_top)){_cami_system.show_list_y=_cami_system.show_list_click_layer_y+5}else{_cami_system.show_list_y=_cami_system.show_list_click_layer_y-_cami_system.show_list_height-5}_cami_system.$("#cami_show_list").stop(true,true).css({'top':_cami_system.show_list_y,'left':_cami_system.show_list_x}).fadeIn()}};_cami_system.panel_placement=function(init,json){init=init||false;json=json||"";var data=(init)?_cami_system.$.parseJSON(json):json;var parent_this=this;var html="";var elasticity_id=this.elasticity_id.split(",");var elem_identity="";for(var i in data){if(!data.hasOwnProperty(i)){continue}for(var j in elasticity_id){if(data[i]["elasticity_id"]!=elasticity_id[j]){continue}if(this.mode=="department"){if(this.elasticity_type=="id"){elem_identity="#cami_system_dp_"+data[i]["elasticity_id"]+""}else{elem_identity=".cami_system_dp_"+data[i]["elasticity_id"]+""}}else{if(this.elasticity_type=="id"){elem_identity="#cami_system_op_"+data[i]["elasticity_id"]+""}else{elem_identity=".cami_system_op_"+data[i]["elasticity_id"]+""}}if(data[i]["state"]==1){_cami_system.$(""+elem_identity+" .cami_system_si").html("<img src=\""+this.pics.online+"\" />")}else if(data[i]["state"]==2){_cami_system.$(""+elem_identity+" .cami_system_si").html("<img src=\""+this.pics.busy+"\" />")}else{_cami_system.$(""+elem_identity+" .cami_system_si").html("<img src=\""+this.pics.offline+"\" />")}if(this.display=="default"){_cami_system.$(""+elem_identity+" .cami_system_sn").html(data[i]["name"])}if(this.mode=="department"){_cami_system.$(elem_identity).data("cami_elasticity_mode","department").data("cami_elasticity_click_id",data[i]["id"])}else{_cami_system.$(elem_identity).data("cami_elasticity_mode","operator").data("cami_elasticity_click_id",data[i]["id"])}_cami_system.$(elem_identity).unbind("click").click(function(){var $this=_cami_system.$(this);var mode=$this.data("cami_elasticity_mode");var click_id=$this.data("cami_elasticity_click_id");_cami_system.open_system(mode,click_id)})}}if(init){_cami_system.$('.cami_trigger').each(function(){var $this=_cami_system.$(this);var assign=$this.data('cami-trigger-assign');var robot=$this.data('cami-trigger-robot');var message=$this.data('cami-trigger-message');if(!message){message=''}if(!assign||assign==''||typeof(_cami_system.duty_hash[assign])=='undefined'){_cami_system.log('Cami Trigger setting error.');return}robot=(robot==1)?'robot':null;$this.on('click',function(){_cami_system.open_system(_cami_system.mode,_cami_system.duty_hash[assign],robot,message)})});if(_cami_system.bridge_setup&&typeof(_cami_system.bridge.customize.complete_callback)=='function'){_cami_system.bridge.customize.complete_callback()}_cami_system.online_status_timeout=setTimeout(function(){_cami_system.online_status_update()},180*1000)}};_cami_system.online_status_update=function(){if(_cami_system.online_status_update_status==true){setTimeout(function(){_cami_system.online_status_update()},10);return false}_cami_system.online_status_update_ajax=_cami_system.$.ajax({type:"GET",url:"http://p37.cami.yesing.com/tw/patrol/elasticity_v2/department/simple/ctc_cs?update",jsonp:"Cami",jsonpCallback:"CamiStatus",dataType:"jsonp",beforeSend:function(){_cami_system.online_status_update_status=true},success:function(response){_cami_system.panel_placement(false,response);_cami_system.online_status_last_time=_cami_system.get_now_time();clearTimeout(_cami_system.online_status_timeout);_cami_system.online_status_timeout=setTimeout(function(){_cami_system.online_status_update()},180*1000)},complete:function(){_cami_system.online_status_update_status=false}})};_cami_system.request_check=function(init){init=init||false;if(!init){if(navigator.onLine===undefined||navigator.onLine===true){var time=_cami_system.get_now_time();if(_cami_system.online_status_last_time!=0&&(time-_cami_system.online_status_last_time)>540){if(_cami_system.online_status_update_ajax!=null){_cami_system.online_status_update_ajax.abort();_cami_system.online_status_update_ajax=null}clearTimeout(_cami_system.online_status_timeout);_cami_system.online_status_update_status=false;_cami_system.online_status_update()}if(_cami_system.refresh_last_time!=0&&(time-_cami_system.refresh_last_time)>540){if(_cami_system.refresh_ajax!=null){_cami_system.refresh_ajax.abort();_cami_system.refresh_ajax=null}clearTimeout(_cami_system.refresh_timeout);_cami_system.refresh_status=false;_cami_system.refresh()}}}clearTimeout(_cami_system.request_check_timeout);_cami_system.request_check_timeout=setTimeout(_cami_system.request_check,60000)};_cami_system.obj_length=function(obj){obj=obj||null;var obj_length=0;if(obj){for(var i in obj){obj_length++}}return obj_length};_cami_system.bridge_sweep=function(key_string){key_string=key_string||"";var len;var bridge;var key_reg=/^[a-zA-Z0-9_]+$/;var key_test=key_string.replace(/[\["|"\]|\['|'\]]/g,"");var key_string_fix;if(key_string!=""&&!key_reg.test(key_test)){return false}if(key_string==""){bridge=_cami_system.bridge}else{eval("bridge = _cami_system.bridge"+key_string+";")}if(typeof(bridge)!="object"){return}len=_cami_system.obj_length(bridge);if(len>0){for(var i in bridge){key_string_fix=""+key_string+"[\""+i+"\"]";_cami_system.bridge_sweep(key_string_fix)}_cami_system.bridge_sweep(key_string_fix)}else{eval("delete _cami_system.bridge"+key_string+";")}};_cami_system.get_bridge=function(type,is_columns){type=type||null;is_columns=is_columns||false;if(type){type=type.split(".").reverse()}var count=type.length;var arr_map="";var map_reg=/^[a-zA-Z0-9_]+$/;var map_test="";var bridge_value=undefined;var bridge_temp;while(count--){arr_map+="[\""+type[count]+"\"]"}map_test=arr_map.replace(/[\["|"\]|\['|'\]]/g,"");if(!is_columns&&map_reg.test(map_test)){try{eval("bridge_value = (cami_bridge"+arr_map+" !== undefined) ? \"\"\+cami_bridge"+arr_map+"\+\"\" : bridge_value;")}catch(e){}}else{type=type.toString();bridge_value=cami_bridge.columns[type]}return bridge_value};_cami_system.bridge_handle=function(){if(typeof(cami_bridge)!="undefined"){_cami_system.bridge_setup=true;_cami_system.bridge_temp.setting={};_cami_system.bridge_temp.setting.timestamp=_cami_system.get_bridge("setting.timestamp");_cami_system.bridge_temp.setting.token=_cami_system.get_bridge("setting.token");_cami_system.bridge_temp.member={};_cami_system.bridge_temp.member.unique_id=_cami_system.get_bridge("member.unique_id");_cami_system.bridge_temp.member.login_required=_cami_system.get_bridge("member.login_required");_cami_system.bridge_temp.member.login_status=_cami_system.get_bridge("member.login_status");_cami_system.bridge_temp.member.no_login_redirect=_cami_system.get_bridge("member.no_login_redirect");_cami_system.bridge_temp.guest_info={};_cami_system.bridge_temp.guest_info.name=_cami_system.get_bridge("guest_info.name");_cami_system.bridge_temp.guest_info.phone=_cami_system.get_bridge("guest_info.phone");_cami_system.bridge_temp.guest_info.email=_cami_system.get_bridge("guest_info.email");_cami_system.bridge_temp.guest_info.question=_cami_system.get_bridge("guest_info.question");_cami_system.bridge_temp.columns={};_cami_system.bridge_temp.style={};_cami_system.bridge_temp.style.pics={};_cami_system.bridge_temp.style.pics.online=_cami_system.get_bridge("style.pics.online");_cami_system.bridge_temp.style.pics.busy=_cami_system.get_bridge("style.pics.busy");_cami_system.bridge_temp.style.pics.offline=_cami_system.get_bridge("style.pics.offline");_cami_system.bridge_temp.style.pics.appear_online=_cami_system.get_bridge("style.pics.appear_online");_cami_system.bridge_temp.style.pics.appear_busy=_cami_system.get_bridge("style.pics.appear_busy");_cami_system.bridge_temp.style.pics.appear_offline=_cami_system.get_bridge("style.pics.appear_offline");_cami_system.bridge_temp.customize={};_cami_system.bridge_temp.customize.service_alert={};_cami_system.bridge_temp.customize.service_alert.switch_on=_cami_system.get_bridge("customize.service_alert.switch_on");_cami_system.bridge_temp.customize.service_alert.department=_cami_system.get_bridge("customize.service_alert.department");_cami_system.bridge_temp.customize.service_alert.first={};_cami_system.bridge_temp.customize.service_alert.first.time=_cami_system.get_bridge("customize.service_alert.first.time");_cami_system.bridge_temp.customize.service_alert.first.message=_cami_system.get_bridge("customize.service_alert.first.message");_cami_system.bridge_temp.customize.service_alert.second={};_cami_system.bridge_temp.customize.service_alert.second.time=_cami_system.get_bridge("customize.service_alert.second.time");_cami_system.bridge_temp.customize.service_alert.second.message=_cami_system.get_bridge("customize.service_alert.second.message");_cami_system.bridge_temp.customize.self_startup=_cami_system.get_bridge("customize.self_startup");if(cami_bridge.columns!==undefined&&typeof(cami_bridge.columns)=="object"){for(var i in cami_bridge.columns){_cami_system.bridge_temp.columns[i.toString()]=_cami_system.get_bridge(i,true)}}_cami_system.bridge=_cami_system.$.extend(true,_cami_system.bridge,_cami_system.bridge_temp);if(_cami_system.bridge.style.pics.online!==undefined){_cami_system.pics.online=_cami_system.bridge.style.pics.online}if(_cami_system.bridge.style.pics.busy!==undefined){_cami_system.pics.busy=_cami_system.bridge.style.pics.busy}if(_cami_system.bridge.style.pics.offline!==undefined){_cami_system.pics.offline=_cami_system.bridge.style.pics.offline}if(_cami_system.bridge.customize.service_alert.switch_on!==undefined){_cami_system.service_alert_1=_cami_system.service_alert_2=_cami_system.bridge.customize.service_alert.switch_on}delete _cami_system.bridge.style;_cami_system.bridge_sweep();_cami_system.bridge_querystring=_cami_system.$.param(_cami_system.bridge);if(_cami_system.bridge.customize===undefined){_cami_system.bridge.customize={}}_cami_system.bridge.customize.complete_callback=(cami_bridge.customize!==undefined&&typeof(cami_bridge.customize.complete_callback)=="function")?cami_bridge.customize.complete_callback:""}};_cami_system.refresh=function(first_run,onload_first_run){first_run=first_run||0;onload_first_run=onload_first_run||0;if(_cami_system.refresh_status==true){setTimeout(function(){_cami_system.refresh(first_run,onload_first_run)},10);return false}if(onload_first_run==1&&_cami_system.bid==""){setTimeout(function(){_cami_system.refresh(first_run,onload_first_run)},10);return false}else{if(_cami_system.mx==_cami_system.lmx&&_cami_system.my==_cami_system.lmy){_cami_system.mnv++}else{_cami_system.mnv=0;_cami_system.lmx=_cami_system.mx;_cami_system.lmy=_cami_system.my}if(first_run==1){var refresh_data={"fs":first_run,"os":_cami_system.check_onload,"olfs":onload_first_run,"hs":_cami_system.hs,"__CAMI_SID":_cami_system.cid,"gid":_cami_system.gid,"gid_exists":_cami_system.gid_exists,"bid":_cami_system.bid,"location":_cami_system.urlencode(document.location),"referer":_cami_system.urlencode(document.referrer),"charset":_cami_system.charset,"sw":screen.width,"sh":screen.height,"fv":_cami_system.get_flash_version(),"mnv":_cami_system.mnv,"sa_1":_cami_system.service_alert_check_1(),"sa_2":_cami_system.service_alert_check_2(),"title":document.title,"keywords":_cami_system.keywords,"bgqs":_cami_system.bridge_querystring}}else{var refresh_data={"fs":first_run,"os":_cami_system.check_onload,"olfs":onload_first_run,"hs":_cami_system.hs,"__CAMI_SID":_cami_system.cid,"gid":_cami_system.gid,"bid":_cami_system.bid,"location":_cami_system.urlencode(document.location),"charset":_cami_system.charset,"mnv":_cami_system.mnv,"sa_1":_cami_system.service_alert_check_1(),"sa_2":_cami_system.service_alert_check_2()}}_cami_system.refresh_ajax=_cami_system.$.ajax({type:"GET",url:"http://p37.cami.yesing.com/tw/patrol/result/ctc_cs?_"+_cami_system.get_now_time()+"",data:refresh_data,dataType:"script",beforeSend:function(){_cami_system.refresh_status=true},success:function(){if(first_run==1){_cami_system.init_form()}else{_cami_system.refresh_last_time=_cami_system.get_now_time();clearTimeout(_cami_system.refresh_timeout);_cami_system.refresh_timeout=setTimeout(function(){_cami_system.refresh()},180000)}},complete:function(){_cami_system.refresh_status=false}})}};_cami_system.init_form=function(){if(_cami_system.check_onload!==1){setTimeout(function(){_cami_system.init_form()},10)}else{var $forms=_cami_system.$(".cami_system_form");if($forms.length>0){var method="POST";var enctype="multipart/form-data";var action="http://p37.cami.yesing.com/tw/client/service_form/ctc_cs";var html=''+'<p><input type="hidden" class="cami_system_elem" name="__CAMI_SID" value="'+_cami_system.cid+'" /></p>'+'<p><input type="hidden" class="cami_system_elem" name="_cami_system_bid" value="'+_cami_system.bid+'" /></p>'+'<p><input type="hidden" class="cami_system_elem" name="_cami_system_form_id" value="" /></p>'+'<p><input type="hidden" class="cami_system_elem" name="_cami_system_charset" value="'+_cami_system.charset+'" /></p>';$forms.each(function(){var $form=_cami_system.$(this);var form_index=$forms.index($form);var form_id=""+_cami_system.urlencode(document.location)+"_"+form_index+"";var form_id_encode_again=""+_cami_system.urlencode(_cami_system.urlencode(document.location))+"_"+form_index+"";$form.attr({"id":form_id,"method":method,"enctype":enctype,"action":action}).prepend(html);_cami_system.$.ajax({type:"POST",url:"http://p37.cami.yesing.com/tw/client/service_form_values/ctc_cs",dataType:"jsonp",data:{"__CAMI_SID":_cami_system.cid,"bid":_cami_system.bid,"form_id":form_id},success:function(json){for(var i in json){var get_col=$form.find("input[name='"+i+"']");if(get_col.length==0){get_col=$form.find("textarea[name='"+i+"']")}get_col.val(json[i])}}});$form.find("input[name='_cami_system_form_id']").val(form_id);$form.css("visibility","visible").animate({"opacity":1},400,function(){_cami_system.$(this).find(".cami_system_verify img").attr("src","http://p37.cami.yesing.com/tw/client/service_form_verify/ctc_cs?_"+_cami_system.get_now_time()+"&bid="+_cami_system.bid+"&fid="+form_id_encode_again+"&__CAMI_SID="+_cami_system.cid+"")})})}}};_cami_system.service_alert_check_1=function(){var check=_cami_system.read_cookie('cami_sa_ignore_1');if(_cami_system.cookie_status!=true||(check&&check==1)){_cami_system.service_alert_1=0}return _cami_system.service_alert_1};_cami_system.service_alert_check_2=function(){var check=_cami_system.read_cookie('cami_sa_ignore_2');if(_cami_system.cookie_status!=true||(check&&check==1)){_cami_system.service_alert_2=0}return _cami_system.service_alert_2};_cami_system.service_alert_cancel=function(type){if(type==1){_cami_system.create_cookie('cami_sa_ignore_1',1)}else if(type==2){_cami_system.create_cookie('cami_sa_ignore_2',1)}document.getElementById('cami_service_alert').style.display='none';this.eventsOn('service_alert_cancel_'+type+'')};_cami_system.robot_active_status=false;_cami_system.robotActive=function(hid,summary,resize){hid=hid||null;summary=summary||null;resize=resize||false;if(_cami_system.ol_check!==1){setTimeout(function(hid,summary,resize){_cami_system.robotActive(hid,summary,resize)},500,hid,summary,resize);return false}if(resize){}var $robot_active=this.$('#cami_robot_active');var $robot_active_alpha_bg=$robot_active.find('.cami_alpha_bg');var $robot_active_content_container=$robot_active.find('.cami_content_container');var $robot_active_content=$robot_active_content_container.find('.cami_content');var $robot_active_close=$robot_active.find('.cami_close');var insert_html='<div onclick="_cami_system.open_system(\'robot_active\', \''+hid+'\'); return false;">'+summary+'</div>';var get_color=this.getElementAverageBgRGB('body');var bg_color={'r':get_color.r,'g':get_color.g,'b':get_color.b};var border_top_color={'r':Math.abs(get_color.r-255)+80,'g':Math.abs(get_color.g-255)+80,'b':Math.abs(get_color.b-255)+80};var shadow_color={'r':Math.abs(get_color.r-255)+160,'g':Math.abs(get_color.g-255)+160,'b':Math.abs(get_color.b-255)+160};var font_color={'r':Math.abs(get_color.r-255)+100,'g':Math.abs(get_color.g-255)+100,'b':Math.abs(get_color.b-255)+100};for(var i in border_top_color){if(border_top_color[i]>255){border_top_color[i]=255}else if(border_top_color[i]<0){border_top_color[i]=0}}for(var i in shadow_color){if(shadow_color[i]>255){shadow_color[i]=255}else if(shadow_color[i]<0){shadow_color[i]=0}}for(var i in font_color){if(font_color[i]>255){font_color[i]=255}else if(font_color[i]<0){font_color[i]=0}}var close_bg_color=bg_color;var close_font_color=font_color;this.robot_active_status=true;if(!this.robot_active_status){$robot_active_content.html(insert_html)}else{$robot_active_content.append(insert_html)}$robot_active_alpha_bg.css({'background-color':'rgb('+bg_color.r+', '+bg_color.g+', '+bg_color.b+')'});$robot_active_content_container.css({'border-top-color':'rgb('+border_top_color.r+', '+border_top_color.g+', '+border_top_color.b+')','box-shadow':'0 2px 2px 0 rgb('+shadow_color.r+', '+shadow_color.g+', '+shadow_color.b+')'});$robot_active_content.find('div').css('color','rgb('+font_color.r+', '+font_color.g+', '+font_color.b+')');$robot_active_close.css('color','rgb('+close_font_color.r+', '+close_font_color.g+', '+close_font_color.b+')');this.robotActiveResize();$robot_active.stop(true).animate({bottom:15},1000,'easeOutExpo')};_cami_system.robotActiveHide=function(){var $robot_active=_cami_system.$('#cami_robot_active');var height=$robot_active.height();this.robot_active_status=false;$robot_active.stop(true).animate({bottom:-height-10},1000,'easeOutExpo')};_cami_system.robotActiveResize=function(){if(!_cami_system.robot_active_status){return false}var $robot_active=this.$('#cami_robot_active');var $robot_active_content_container=$robot_active.find('.cami_content_container');var $robot_active_content=$robot_active_content_container.find('.cami_content');var content_height=$robot_active_content.prop('scrollHeight');if(content_height>200){$robot_active_content_container.css('height','200')}else{$robot_active_content_container.css('height','')}};_cami_system.getElementAverageBgRGB=function(jq_selector){if(!jq_selector){return false}var $elem=_cami_system.$(jq_selector).eq(0);var body_image=$elem.css('background-image');var body_color=$elem.css('background-color');var rgb={r:255,g:255,b:255};var image_url,image_obj;if(!body_image||body_image==''||body_image=='none'){if(body_color!='rgba(0, 0, 0, 0)'&&body_color!='transparent'){body_color=body_color.replace('rgb(','').replace('rgba(','').replace(')','').split(',');rgb.r=parseInt(body_color[0]);rgb.g=parseInt(body_color[1]);rgb.b=parseInt(body_color[2])}}else if(!_cami_system.user_browser.ie6&&!_cami_system.user_browser.ie7&&!_cami_system.user_browser.ie8){image_url=body_image.replace('url(','').replace(')','').replace(/"/g,'');image_obj=document.createElement('img');image_obj.src=image_url;rgb=this.getImageAverageRGB(image_obj)}return rgb};_cami_system.getImageAverageRGB=function(image){var check_px=5;var default_rgb={r:255,g:255,b:255};var canvas=document.createElement('canvas');var context=canvas.getContext&&canvas.getContext('2d');var data,width,height;var i=check_px*-1+1;var length;var rgb={r:255,g:255,b:255};var count=0;if(!context){return default_rgb}width=canvas.width=image.naturalWidth||image.offsetWdith||image.width;height=canvas.height=image.naturalHeight||image.offsetHeight||image.height;context.drawImage(image,0,0);try{data=context.getImageData(0,0,width,height)}catch(e){return default_rgb}length=data.data.length;while((i+=check_px*4)<length){count++;rgb.r+=data.data[i];rgb.g+=data.data[i+1];rgb.b+=data.data[i+2]}rgb.r=~~(rgb.r/count);rgb.g=~~(rgb.g/count);rgb.b=~~(rgb.b/count);return rgb};_cami_system.open_system=function(mode,aim,special,message){mode=mode||"";aim=aim||"";special=special||"";message=message||'';if(!mode||!aim){return false}var win;var action="client/)3(/ctc_cs?mode="+mode+"";if(mode=="department"){action+="&d="+aim+""}else if(mode=="operator"){action+="&o="+aim+""}else if(mode=="robot_active"){action+="&ak="+aim+""}if(special.substr(0,3)=="fsa"){action+="&fsa=1"}else if(special=="at"){action+="&at=1"}else if(special=="robot"){action+="&gr=1"}if(message!=''){action+='&m='+_cami_system.base64_encode(message)+''}action+="&bid="+this.bid+"";if(special.substr(0,3)=="fsa"){_cami_system.create_cookie("cami_sa_ignore_1",1);_cami_system.create_cookie("cami_sa_ignore_2",1);document.getElementById("cami_service_alert").style.display="none";var saType=special.substr(3);this.eventsOn('service_alert_click_'+saType+'')}_cami_system.action_number++;function startup(){if(_cami_system.bridge_setup&&_cami_system.bridge.customize.self_startup==1){}else{win=window.open("","_cami_form_1496743138_"+_cami_system.action_number+"","width=820,height=500,scrollbars=yes,status=1,resizable=1")}}function exec_action(){var $form=_cami_system.$("<form>").css("display","none").attr("method","POST").attr("action","http://p37.cami.yesing.com/tw/"+action+"");if(_cami_system.bridge_setup&&_cami_system.bridge.customize.self_startup==1){}else{$form.attr("target","_cami_form_1496743138_"+_cami_system.action_number+"")}var $input_cid=_cami_system.$("<input type=\"hidden\">").attr("name","__CAMI_SID").val(""+_cami_system.cid+"");var $input_token=_cami_system.$("<input type=\"hidden\">").attr("name","_form_token").val("8d61bc2bea53317b1e70c792c69cf0489b7023caecac7605ed630661434aaf57d633aaeea7785cef24fff44982850100e264dc0f817504084cac648343ba04db");$input_cid.prependTo($form);$input_token.prependTo($form);$form.appendTo("body").submit().remove()}if(!_cami_system.mobile_device){startup();if(win){if(!win.closed){exec_action()}else{setTimeout(exec_action,1000)}}else{exec_action()}}else{exec_action()}};_cami_system.eventsOn=function(type){type=type||null;if(type!==null&&typeof(this.extension.eventsOn)=='function'){this.extension.eventsOn(type)}};_cami_system.log=function(log){log=log||"";if((typeof(console)=="object"&&typeof(console.log)=="object")||(typeof(console)=="object"&&typeof(console.log)=="function")){console.log("Cami: "+log)}};_cami_system.extension.get_service_status=function(){var service_status="unknown";if(_cami_system.include=="slide"&&_cami_system.display=="text"){var now_status_image=_cami_system.$("#cami_patrol_tool_appear img").attr("src");if(now_status_image==_cami_system.pics_appear.online){service_status="online"}else if(now_status_image==_cami_system.pics_appear.busy){service_status="busy"}else if(now_status_image==_cami_system.pics_appear.offline){service_status="offline"}}else if(_cami_system.include=="static_v2"&&_cami_system.display=="text"){var online=_cami_system.$("#cami_patrol_tool .cami_state_color_online").length;var busy=_cami_system.$("#cami_patrol_tool .cami_state_color_busy").length;if(online>=1){service_status="online"}else if(online<1&&busy>=1){service_status="busy"}else if(online==0&&busy==0){service_status="offline"}}else if((_cami_system.include=="slide"||_cami_system.include=="static_v2")&&_cami_system.display=="image"){var now_status_image=_cami_system.$("#cami_patrol_tool img").attr("src");if(now_status_image==_cami_system.pics.online){service_status="online"}else if(now_status_image==_cami_system.pics.busy){service_status="busy"}else if(now_status_image==_cami_system.pics.offline){service_status="offline"}}else if(_cami_system.include=="elasticity_v2"){var $si_image=_cami_system.$(".cami_system_si img");var online=0;var busy=0;_cami_system.$.each($si_image,function(){if(this.src==_cami_system.pics.online){online++}else if(this.src==_cami_system.pics.busy){busy++}});if(online>=1){service_status="online"}else if(online<1&&busy>=1){service_status="busy"}else if(online==0&&busy==0){service_status="offline"}}return service_status};_cami_system.extension.eventsOn=function(type){type=type||null};_cami_system.load_css();_cami_system.load_js()}